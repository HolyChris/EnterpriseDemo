!function(){"use strict";var a=angular.module("flash",[]);a.run(["$rootScope",function(a){a.flash={},a.flash.text="",a.flash.type="",a.flash.timeout=5e3,a.hasFlash=!1}]),a.directive("dynamic",["$compile",function(a){return{restrict:"A",replace:!0,link:function(b,c,d){b.$watch(d.dynamic,function(d){c.html(d),a(c.contents())(b)})}}}]),a.directive("closeFlash",["$compile","Flash",function(a,b){return{link:function(a,c){c.on("click",function(){b.dismiss()})}}}]),a.directive("flashMessage",["$compile","$rootScope",function(a,b){return{restrict:"A",template:'<div role="alert" ng-show="hasFlash" class="alert {{flash.addClass}} alert-{{flash.type}} alert-dismissible"> <span dynamic="flash.text"></span> <button type="button" class="close" close-flash><span aria-hidden="true">(Hide message)</span><span class="sr-only">Close</span></button> </div>',link:function(a,c,d){b.flash.timeout=parseInt(d.flashMessage,10)}}}]),a.factory("Flash",["$rootScope","$timeout",function(a,b){var c,d={};return d.create=function(d,e,f){var g=this;b.cancel(c),a.flash.type=d,a.flash.text=e,a.flash.addClass=f,b(function(){a.hasFlash=!0},100),c=b(function(){g.dismiss()},a.flash.timeout)},d.pause=function(){b.cancel(c)},d.dismiss=function(){b.cancel(c),b(function(){a.hasFlash=!1})},d}])}(),angular.module("ersApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","ui.sortable","ui.router","angular-table","flash"]).config(["$stateProvider","$urlRouterProvider",function(a,b){a.state("main",{url:"/",templateUrl:"views/main.html",controller:"MainCtrl"}).state("customers",{url:"/customers",templateUrl:"views/customer.html",controller:"AboutCtrl"}).state("newcustomer",{url:"/customers/new",templateUrl:"views/new_customer.html",controller:"NewCustomerCtrl"}).state("editcustomer",{url:"/customers/:id/edit",templateUrl:"views/edit_customer.html",controller:"EditCustomerCtrl"}).state("customers.overview",{url:"/overview",templateUrl:"views/customer_overview.html"}).state("sites",{url:"/sites",templateUrl:"views/sites.html",controller:"SitesCtrl"}).state("newsite",{url:"/sites/new",templateUrl:"views/new_site.html",controller:"NewSiteCtrl"}).state("overview",{url:"/overview",templateUrl:"views/overview.html",controller:"OverviewCtrl"}).state("overview.project",{url:"/project",templateUrl:"views/overview_project.html"}).state("overview.contract",{url:"/contract",templateUrl:"views/overview_contract.html"}).state("overview.project_doc",{url:"/project-documents",templateUrl:"views/overview_project_doc.html"}).state("overview.project_doc.photos",{url:"/photos",templateUrl:"views/overview_project_doc-photos.html"}).state("overview.production",{url:"/production",templateUrl:"views/overview_production.html"}),b.otherwise("/")}]),angular.module("ersApp").run(["$http",function(a){a.defaults.headers.common={"X-Auth-Token":"D2EdWKgbs8cq9PHyLhrA"}}]).controller("MainCtrl",["$scope","$http","$window","$location",function(a,b,c,d){var e,f,g;a.sortableOptionsList=[{placeholder:"card-highlight",cursor:"-webkit-grabbing",items:".pipe-card:not(.create-opp)",start:function(a,b){g=b.item,f=e=b.item.parent()},stop:function(a,b){d.path("/overview/contract")},change:function(a,b){b.sender&&(f=b.placeholder.parent())},connectWith:"#con-cards"},{connectWith:"#pro-cards,#opp-cards",placeholder:"card-highlight",cursor:"-webkit-grabbing",start:function(a,b){g=b.item,f=e=b.item.parent()},stop:function(a,b){d.path("/overview/production")},change:function(a,b){b.sender&&(f=b.placeholder.parent())}},{connectWith:"#con-cards,#post-cards",placeholder:"card-highlight",cursor:"-webkit-grabbing",start:function(a,b){g=b.item,f=e=b.item.parent()},stop:function(a,b){},change:function(a,b){b.sender&&(f=b.placeholder.parent())}},{connectWith:"#pro-cards,#close-cards",placeholder:"card-highlight",cursor:"-webkit-grabbing",start:function(a,b){g=b.item,f=e=b.item.parent()},stop:function(a,b){},change:function(a,b){b.sender&&(f=b.placeholder.parent())}},{connectWith:"#post-cards",placeholder:"card-highlight",cursor:"-webkit-grabbing",items:".pipe-card:not(.out-amount)",start:function(a,b){g=b.item,f=e=b.item.parent()},stop:function(a,b){},change:function(a,b){b.sender&&(f=b.placeholder.parent())}}],a.state_abb=["MI","SD","WA","WI","AZ","IL","NH","NC","KS","MO","AR","NV","DC","ID","NE","PA","HI","UT","VT","DE","RI","OK","LA","MT","TN","MD","FL","VA","MN","NJ","OH","CA","ND","ME","IN","TX","OR","WY","AL","IA","MS","KY","NM","GA","CO","MA","CT","NY","SC","AK","WV","AA","AE","AP"],b({method:"GET",url:"http://54.68.73.69/api/v1/sites",headers:{"Content-type":"application/json"}}).success(function(b){a.recent_sites=b}).error(function(){alert("error")}),b({method:"GET",url:"http://54.68.73.69/api/v1/sites?stage=Opportunity",headers:{"Content-type":"application/json"}}).success(function(b){a.opportunities=b}).error(function(){alert("error")}),b({method:"GET",url:"http://54.68.73.69/api/v1/sites?stage=UnderContract",headers:{"Content-type":"application/json"}}).success(function(b){a.contracts=b}).error(function(){alert("error")}),b({method:"GET",url:"http://54.68.73.69/api/v1/sites?stage=Production",headers:{"Content-type":"application/json"}}).success(function(b){a.productions=b}).error(function(){alert("error")}),b({method:"GET",url:"http://54.68.73.69/api/v1/sites?stage=Billing",headers:{"Content-type":"application/json"}}).success(function(b){a.billings=b}).error(function(){alert("error")})}]),angular.module("ersApp").controller("SitesCtrl",["$scope","$http",function(a,b){a.config={itemsPerPage:10},a.state_abb=["MI","SD","WA","WI","AZ","IL","NH","NC","KS","MO","AR","NV","DC","ID","NE","PA","HI","UT","VT","DE","RI","OK","LA","MT","TN","MD","FL","VA","MN","NJ","OH","CA","ND","ME","IN","TX","OR","WY","AL","IA","MS","KY","NM","GA","CO","MA","CT","NY","SC","AK","WV","AA","AE","AP"],a.selected=1,a.isActive=function(b){return a.selected===b},a.gotopage=function(c){a.selected=c,b({method:"GET",url:"http://54.68.73.69/api/v1/sites?page="+c,headers:{"Content-type":"application/json"}}).success(function(b){a.sites=b,a.siteList=b.sites}).error(function(){alert("error")})},a.pagerange=function(a,b,c){c=c||1;for(var d=[],e=a;b>=e;e+=c)d.push(e);return d},b({method:"GET",url:"http://54.68.73.69/api/v1/sites",headers:{"Content-type":"application/json"}}).success(function(b){a.sites=b,a.siteList=b.sites}).error(function(){alert("error")})}]),angular.module("ersApp").run(["$http",function(a){a.defaults.headers.common={"X-Auth-Token":"D2EdWKgbs8cq9PHyLhrA"}}]).controller("NewSiteCtrl",["$scope","$http",function(a,b){a.flag=0,a.siteAddress={},a.billAddress={},a.siteDetail={},a.$watch("billingIsSameAsSite",function(b){b?(a.flag=1,a.billAddress=a.siteAddress):(a.flag=0,a.billAddress=angular.copy(a.billAddress))}),a.state_abb=["MI","SD","WA","WI","AZ","IL","NH","NC","KS","MO","AR","NV","DC","ID","NE","PA","HI","UT","VT","DE","RI","OK","LA","MT","TN","MD","FL","VA","MN","NJ","OH","CA","ND","ME","IN","TX","OR","WY","AL","IA","MS","KY","NM","GA","CO","MA","CT","NY","SC","AK","WV","AA","AE","AP"],a.siteSource=["Qualified Storm Leads","Commercial Call Leads","Self-Generated","Canvasser","Call in Leads","Mailer","Sign","Website","Friend","Neighbor","Truck Sign","Call/Knock","Other","Existing Customer"],a.newSite=function(c,d,e){b({method:"POST",url:"http://54.68.73.69/api/v1/sites?customer_id=109&name="+d.name+"&contact_name="+d.contact_name+"&contact_phone="+d.contact_phone+"&manage_ids[]=1&manage_ids[]=2&source="+d.source+"&source_info="+d.source_info+"&status="+d.status+"&damage="+d.damage+"&address_attributes[address1]="+c.address1+"&address_attributes[address2]="+c.address2+"&address_attributes[city]="+c.address2+"&address_attributes[state_id]="+c.state_id+"&address_attributes[zipcode]="+c.zipcode+"&bill_addr_same_as_addr="+a.flag+"&bill_address_attributes[address1]="+e.address1+"&bill_address_attributes[address2]="+e.address2+"&bill_address_attributes[city]="+e.city+"&bill_address_attributes[state_id]="+e.state_id+"&bill_address_attributes[zipcode]="+e.zipcode,headers:{"Content-type":"application/json"}}).success(function(a){}).error(function(){alert("error")})}}]),angular.module("ersApp").controller("NewCustomerCtrl",["$scope","$http","$location","Flash",function(a,b,c,d){a.user={},a.phone_number={},a.newCustomer=function(e,f){b({method:"POST",url:"http://54.68.73.69/api/v1/customers?phone_numbers_attributes[0][number]="+f.number+"&phone_numbers_attributes[0][num_type]=1&phone_numbers_attributes[0][primary]=true",params:e,headers:{"Content-type":"application/json"}}).success(function(b){a.customers=b;var e='You have succesfully created a customer. <a href="#" class="alert-link">Click here to create a site </a> for this customer.';d.create("success",e),a.Flash=d,a.custList=b.customers,c.path("/customers/overview")}).error(function(b){a.errors=b,alert("Error Adding a New Customer. Please Try Again")})}}]),angular.module("ersApp").controller("AboutCtrl",["$scope","$http","Flash",function(a,b,c){a.config={itemsPerPage:10},a.selected=1,a.Flash=c,a.isActive=function(b){return a.selected===b},a.gotopage=function(c){a.selected=c,b({method:"GET",url:"http://54.68.73.69/api/v1/customers?page="+c,headers:{"Content-type":"application/json"}}).success(function(b){a.customers=b,a.custList=b.customers}).error(function(){alert("error")})},b({method:"GET",url:"http://54.68.73.69/api/v1/customers",headers:{"Content-type":"application/json"}}).success(function(b){a.customers=b,a.custList=b.customers}).error(function(){alert("error")}),a.pagerange=function(a,b,c){c=c||1;for(var d=[],e=a;b>=e;e+=c)d.push(e);return d}}]),angular.module("ersApp").controller("OverviewCtrl",["$scope",function(a){a.config={itemsPerPage:10},a.photoList=[{stage:"contract",thumbnail:"/images/thumb1.png",title:"john doe-roof 1"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"},{stage:"lead",thumbnail:"/images/thumb2.png",title:"john doe-roof 2"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"},{stage:"lead",thumbnail:"/images/thumb2.png",title:"john doe-roof 2"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"},{stage:"lead",thumbnail:"/images/thumb2.png",title:"john doe-roof 2"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"},{stage:"lead",thumbnail:"/images/thumb2.png",title:"john doe-roof 2"},{stage:"lead",thumbnail:"/images/thumb3.png",title:"john doe-roof 3"}],a.docList=[{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"},{doc_type:"material list",doc_name:"johndoe_materialist.docx"}]}]);